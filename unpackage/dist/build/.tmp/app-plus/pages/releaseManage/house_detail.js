(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/releaseManage/house_detail"],{"070f":function(e,t,s){"use strict";s("83ff");var a=n(s("b0ce")),i=n(s("a877"));function n(e){return e&&e.__esModule?e:{default:e}}Page((0,a.default)(i.default))},"22cb":function(e,t,s){"use strict";s.r(t);var a=s("2417"),i=s.n(a);for(var n in a)"default"!==n&&function(e){s.d(t,e,function(){return a[e]})}(n);t["default"]=i.a},2417:function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s("2f62"),i=s("942f"),n=o(s("8534"));s("3c10");function o(e){return e&&e.__esModule?e:{default:e}}function c(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},a=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(s).filter(function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable}))),a.forEach(function(t){l(e,t,s[t])})}return e}function l(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r={data:function(){return{pageType:"",houseInfo:{},isDeling:!1,isAgree:!1,basicComplete:!1,bedComplete:!1,houseDescComplete:!1,facilitiesComplete:!1,priceComplete:!1,pictureComplete:!1,releasing:!1}},onLoad:function(e){e.type&&(this.pageType=e.type)},onShow:function(){this.checkoutHouseInfo()},onBackPress:function(e){},onNavigationBarButtonTap:function(e){0===e.index&&this.previewHouse()},computed:c({},(0,a.mapState)(["releaseObj","isEditReleaseInfo"]),{releaseStatus:{get:function(){return!!(this.basicComplete&&this.bedComplete&&this.houseDescComplete&&this.facilitiesComplete&&this.priceComplete&&this.pictureComplete)}},isReleaseHouse:{get:function(){return!!(this.isAgree&&this.basicComplete&&this.bedComplete&&this.houseDescComplete&&this.facilitiesComplete&&this.priceComplete&&this.pictureComplete)}}}),methods:c({},(0,a.mapMutations)(["editReleaseInfo","clearReleaseInfo","editReleaseInfoStatus"]),{pageTo:function(t,s){var a="";if(s){var i=JSON.stringify(s);a="/pages/releaseManage/"+t+"?param"+i}else a="/pages/releaseManage/"+t;e.navigateTo({url:a})},agreeChange:function(e){this.isAgree=e.detail.value},checkoutHouseInfo:function(){var e=this.releaseObj.id,t=this;(0,i.request)({url:"/wap/api/fangdong.php?action=checkHouseInfo&house_id="+e,success:function(e){if("success"===e.data.status){var s=e.data.content;t.basicComplete=1===s.simple,t.bedComplete=1===s.bed,t.houseDescComplete=1===s.description,t.facilitiesComplete=1===s.facilities,t.priceComplete=1===s.money,t.pictureComplete=1===s.picture}else n.default.layer("验证房源信息失败")},complete:function(){}})},editRentType:function(){0!=this.releaseObj.status&&1!=this.releaseObj.status?e.navigateTo({url:"/pages/releaseManage/rent_type?type=edit"}):n.default.layer("无法编辑上架或者审核中的房源!")},editLocal:function(){0!=this.releaseObj.status&&1!=this.releaseObj.status?e.navigateTo({url:"/pages/releaseManage/local_set?type=edit"}):n.default.layer("无法编辑上架或者审核中的房源!")},deleteHouse:function(){if(!this.isDeling){var t=this,s=t.releaseObj.id;e.showModal({title:"删除",content:"是否要删除该房源",confirmText:"删除",confirmColor:"#F05B72",success:function(a){t.isDeling=!0,a.confirm?(e.showLoading({mask:!0,title:"删除中..."}),(0,i.request)({url:"/wap/api/fangdong.php?action=destroyHouse&house_id="+s,success:function(s){"success"===s.data.status?(e.hideLoading(),t.editReleaseInfoStatus(!0),e.navigateBack({delta:1})):n.default.layer(s.data.errorMsg)},complete:function(){t.isDeling=!1}})):a.cancel}})}},releaseHouse:function(){var e=this,t=e.releaseObj.id;e.releasing||(e.isReleaseHouse?(e.releasing=!0,(0,i.request)({url:"/wap/api/fangdong.php?action=publishHouse&house_id="+t+"&protocol=1",success:function(t){if("success"===t.data.status){var s=t.data.content;e.editReleaseInfo(s),e.editReleaseInfoStatus(!0)}else n.default.layer("发布失败")},fail:function(){},complete:function(){e.releasing=!1}})):n.default.layer("请先完善房源信息!"))},downHouse:function(){var t=this,s=t.releaseObj.id;t.releasing||e.showModal({title:"",content:"您确定要下架此房源吗?",confirmText:"下架",cancelText:"我再想想",success:function(e){if(e.confirm){var a={house_id:s,status:"2"};t.releasing=!0,(0,i.request)({url:"/wap/api/fangdong.php?action=improveHouse",method:"POST",data:a,success:function(e){if("success"===e.data.status){var s=e.data.content;t.editReleaseInfo(s),t.editReleaseInfoStatus(!0)}else n.default.layer("下架失败,请重试!")},complete:function(){t.releasing=!1}})}else e.cancel}})},previewHouse:function(){var t=this,s=(t.releaseObj.status,t.releaseObj.is_complete);"0"===s?e.showModal({title:"",content:"完善房源信息后才可预览",confirmText:"知道了",showCancel:!1}):e.navigateTo({url:"/pages/releaseManage/preview_house"})}})};t.default=r}).call(this,s("6e42")["default"])},"7fc6":function(e,t,s){},a877:function(e,t,s){"use strict";s.r(t);var a=s("b381"),i=s("22cb");for(var n in i)"default"!==n&&function(e){s.d(t,e,function(){return i[e]})}(n);s("db4c"),s("d430");var o=s("2877"),c=Object(o["a"])(i["default"],a["a"],a["b"],!1,null,"4af3422e",null);t["default"]=c.exports},b381:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",{staticClass:"house_detail_page"},[s("view",{staticClass:"house_status",domProps:{textContent:e._s(e.releaseStatus?"已完成":"未完成")}}),s("view",{staticClass:"house_detail_form"},[s("view",{staticClass:"form_item",attrs:{eventid:"bf050e44-0"},on:{tap:function(t){e.pageTo("house_basic_info/house_basic_info")}}},[s("view",{staticClass:"label"},[e._v("基本信息")]),s("view",{staticClass:"ipt"},[e.basicComplete?s("view",{staticClass:"data_box"},[e._v("完成")]):s("view",{staticClass:"empty"},[e._v("未完成")])]),e._m(0)]),s("view",{staticClass:"form_item",attrs:{eventid:"bf050e44-1"},on:{tap:function(t){e.pageTo("bed_info/bed_info")}}},[s("view",{staticClass:"label"},[e._v("床铺信息")]),s("view",{staticClass:"ipt"},[e.bedComplete?s("view",{staticClass:"data_box"},[e._v("完成")]):s("view",{staticClass:"empty"},[e._v("未完成")])]),e._m(1)]),s("view",{staticClass:"form_item",attrs:{eventid:"bf050e44-2"},on:{tap:function(t){e.pageTo("house_describe/house_describe")}}},[s("view",{staticClass:"label"},[e._v("房间描述")]),s("view",{staticClass:"ipt"},[e.houseDescComplete?s("view",{staticClass:"data_box"},[e._v("完成")]):s("view",{staticClass:"empty"},[e._v("未完成")])]),e._m(2)]),s("view",{staticClass:"form_item",attrs:{eventid:"bf050e44-3"},on:{tap:function(t){e.pageTo("house_facilities/house_facilities")}}},[s("view",{staticClass:"label"},[e._v("配套设施")]),s("view",{staticClass:"ipt"},[e.facilitiesComplete?s("view",{staticClass:"data_box"},[e._v("完成")]):s("view",{staticClass:"empty"},[e._v("未完成")])]),e._m(3)]),s("view",{staticClass:"form_item",attrs:{eventid:"bf050e44-4"},on:{tap:function(t){e.pageTo("price_rule/price_rule")}}},[s("view",{staticClass:"label"},[e._v("价格规则")]),s("view",{staticClass:"ipt"},[e.priceComplete?s("view",{staticClass:"data_box"},[e._v("完成")]):s("view",{staticClass:"empty"},[e._v("未完成")])]),e._m(4)]),s("view",{staticClass:"form_item",attrs:{eventid:"bf050e44-5"},on:{tap:function(t){e.pageTo("room_photograph/room_photograph")}}},[s("view",{staticClass:"label"},[e._v("房间照片")]),s("view",{staticClass:"ipt"},[e.pictureComplete?s("view",{staticClass:"data_box"},[e._v("完成")]):s("view",{staticClass:"empty"},[e._v("未完成")])]),e._m(5)]),s("view",{staticClass:"form_item",attrs:{eventid:"bf050e44-6"},on:{tap:function(t){e.editRentType()}}},[s("view",{staticClass:"label"},[e._v("出租类型")]),s("view",{staticClass:"ipt"},[e.releaseObj.leasetype?e._e():s("view",{staticClass:"empty"},[e._v("未完成")]),e.releaseObj.leasetype?s("view",{staticClass:"data_box"},["1"===e.releaseObj.leasetype?s("text",[e._v("整套房屋")]):e._e(),"2"===e.releaseObj.leasetype?s("text",[e._v("独立房间")]):e._e(),"3"===e.releaseObj.leasetype?s("text",[e._v("合住房间")]):e._e()]):e._e()]),e._m(6)]),s("view",{staticClass:"form_item",attrs:{eventid:"bf050e44-7"},on:{tap:function(t){e.editLocal()}}},[s("view",{staticClass:"label"},[e._v("房源地址")]),s("view",{staticClass:"ipt"},[e.releaseObj.xz_local?s("view",{staticClass:"data_box"},[e._v("完成")]):s("view",{staticClass:"empty"},[e._v("未完成")])]),e._m(7)]),-1==e.releaseObj.status||2==e.releaseObj.status?s("view",{staticClass:"form_item"},[e._m(8),s("view",{staticClass:"ipt"},[s("switch",{staticClass:"o-switch",attrs:{color:"#F05B72",checked:e.isAgree,eventid:"bf050e44-8"},on:{change:e.agreeChange}})])]):e._e()]),s("view",{staticClass:"bottom_wrap"},[-1==e.releaseObj.status||2==e.releaseObj.status?s("view",{staticClass:"del_house",attrs:{eventid:"bf050e44-9"},on:{tap:function(t){e.deleteHouse()}}},[e._v("删除房源")]):e._e()]),-1==e.releaseObj.status?s("button",{staticClass:"release_btn my-btn-block",class:{dis_btn:!e.isReleaseHouse||e.releasing},attrs:{eventid:"bf050e44-10"},domProps:{textContent:e._s(e.releasing?"发布中...":"马上发布")},on:{tap:function(t){t.stopPropagation(),e.releaseHouse(t)}}}):e._e(),2==e.releaseObj.status?s("button",{staticClass:"release_btn my-btn-block",class:{dis_btn:!e.isReleaseHouse||e.releasing},attrs:{eventid:"bf050e44-11"},domProps:{textContent:e._s(e.releasing?"发布中...":"重新发布")},on:{tap:function(t){t.stopPropagation(),e.releaseHouse(t)}}}):e._e(),0==e.releaseObj.status?s("button",{staticClass:"my-btn-block dis_btn"},[e._v("审核中...")]):e._e(),1==e.releaseObj.status?s("button",{staticClass:"my-btn-block",class:{dis_btn:e.releasing},attrs:{eventid:"bf050e44-12"},domProps:{textContent:e._s(e.releasing?"正在下架...":"下架房源")},on:{tap:function(t){t.stopPropagation(),e.downHouse(t)}}}):e._e()],1)},i=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",{staticClass:"after_icon"},[s("text",{staticClass:"iconfont icon-right"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",{staticClass:"after_icon"},[s("text",{staticClass:"iconfont icon-right"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",{staticClass:"after_icon"},[s("text",{staticClass:"iconfont icon-right"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",{staticClass:"after_icon"},[s("text",{staticClass:"iconfont icon-right"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",{staticClass:"after_icon"},[s("text",{staticClass:"iconfont icon-right"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",{staticClass:"after_icon"},[s("text",{staticClass:"iconfont icon-right"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",{staticClass:"after_icon"},[s("text",{staticClass:"iconfont icon-right"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",{staticClass:"after_icon"},[s("text",{staticClass:"iconfont icon-right"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",{staticClass:"content"},[e._v("我已经阅读并同意"),s("text",[e._v("《房东规则》")]),s("text",[e._v("《房源上线标准》")])])}];s.d(t,"a",function(){return a}),s.d(t,"b",function(){return i})},d430:function(e,t,s){"use strict";var a=s("ee93"),i=s.n(a);i.a},db4c:function(e,t,s){"use strict";var a=s("7fc6"),i=s.n(a);i.a},ee93:function(e,t,s){}},[["070f","common/runtime","common/vendor"]]]);